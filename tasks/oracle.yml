---
version: '3'

vars:
  ORACLE_TF_DIR: "{{.TERRAFORM_DIR}}/oracle"

tasks:
  terraform-fmt:
    internal: true
    dir: "{{.ORACLE_TF_DIR}}"
    cmds:
      - terraform plan -compact-warnings

  terraform-plan:
    internal: true
    dir: "{{.ORACLE_TF_DIR}}"
    cmds:
      - terraform plan -compact-warnings

  terraform-apply:
    internal: true
    dir: "{{.ORACLE_TF_DIR}}"
    cmds:
      - terraform apply -auto-approve

  check:
    dir: "{{.ORACLE_TF_DIR}}"
    desc: Check Oracle Cloud code
    cmds:
      - task: terraform-fmt
      - task: terraform-plan

  update:
    dir: "{{.ORACLE_TF_DIR}}"
    desc: Update Oracle Cloud
    cmds:
      - task: terraform-fmt
      - task: terraform-apply
